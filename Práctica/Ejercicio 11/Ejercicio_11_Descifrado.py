from Crypto.PublicKey import RSA
from Crypto.Cipher import PKCS1_OAEP
from Crypto.Hash import SHA256

import os

import os

my_path = os.path.abspath(os.getcwd())

fichero_fpriv = "C:\\Users\\dmore\\Desktop\\Ciberseguridad\\Criptografia\\Hashing\\clave-rsa-oaep-priv.pem"
fpriv=open(fichero_fpriv,'r')
keypr= RSA.import_key(fpriv.read())



texto_cifrado = bytes.fromhex("b72e6fd48155f565dd2684df3ffa8746d649b11f0ed4637fc4c99d18283b32e1709b30c96b4a8a20d5dbc639e9d83a53681e6d96f76a0e4c279f0dffa76a329d04e3d3d4ad629793eb00cc76d10fc00475eb76bfbc1273303882609957c4c0ae2c4f5ba670a4126f2f14a9f4b6f41aa2edba01b4bd586624659fca82f5b4970186502de8624071be78ccef573d896b8eac86f5d43ca7b10b59be4acf8f8e0498a455da04f67d3f98b4cd907f27639f4b1df3c50e05d5bf63768088226e2a9177485c54f72407fdf358fe64479677d8296ad38c6f177ea7cb74927651cf24b01dee27895d4f05fb5c161957845cd1b5848ed64ed3b03722b21a526a6e447cb8ee")

descifrador = PKCS1_OAEP.new(keypr,SHA256)
decrypted = descifrador.decrypt(texto_cifrado)

print("Descifrado:", decrypted.hex())


#dc767708508c68b9106fc6b9b39ff2a225e7ce0ab8b7795f706e473d9bdd4933c7fd5c7e378dfb615f2c18d142e422693d573f6cd693fa42940af019b3565cddac07ee0fa811981ac852e31b8c40a50b77fa46e04095f54f73172e54422123886526520cba25ea35c62a29e3950245f9fadc61dc1364012c3ff29110afa07adddebef5d6c12e20719e2664dd277e1dc090f65e6c9c3c786659acb4b8c55ff70360ed6946d6319474578eddcb7c127cb701978050ac108de7b18ce5f59d99d0c92da63a4df90d5760257530182c770a70c6e74d752ecd847313d7002238db009353fee0ce761b8356fe4263c4a7e6fa254885470a8fbac97a34fa4de36421135f